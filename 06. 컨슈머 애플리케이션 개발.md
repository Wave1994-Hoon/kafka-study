## 06. 컨슈머 애플리케이션 개발

### 컨슈머 내부 구조
![image](https://user-images.githubusercontent.com/60383031/189049982-90dba16b-cae6-4942-8124-1005650837ca.png)

- Fetcher: 리더 파티션으로부터 레코드를 미리 가져와서 대기
- poll(): Fetcher 에 있는 레코드들을 리턴하는 메서드
- ConsumerRecords: 처리하고자 하는 레코드들의 모음, 오프셋이 포함되어 있다.


<br>

### 리밸런싱
![image](https://user-images.githubusercontent.com/60383031/189051628-604a26a3-4f4b-4299-8521-4974378083aa.png)

컨슈머 그룹으로 이루어진 컨슈머에서 장애 발생 -> 파티션은 장애가 발생하지 않은 컨슈머에 소유권이 넘어가는 행위

<br>

### 커밋
![image](https://user-images.githubusercontent.com/60383031/189054989-5525699f-9d51-4989-9417-eb9fda0b4fe6.png)

컨슈머는 카프카 브로커로부터 데이터를 어디까지 가져갔는지 커밋을 통해 기록한다.

특정 토픽의 파티션을 어떤 컨슈머 그룹이 몇 번째 가져갔는지 카프카 브로커 내부에서 사용되는 내부 토픽 (_consumer_offsets) 에 기록된다.
